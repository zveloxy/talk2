<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Talk2 Chat</title>
    <link rel="stylesheet" href="/style.css?v=63">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icons/7.2.3/css/flag-icons.min.css">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <meta name="theme-color" content="#6366f1">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js');
            });
        }
    </script>
</head>
<body>
    <div id="app">
        <!-- Nickname Modal -->
        <div id="nickname-overlay" class="overlay">
            <div class="modal" id="nickname-modal" style="opacity: 0; transition: opacity 0.3s;">
                <div class="modal-icon"><img src="/logo.svg" alt="Logo" style="width: 64px; height: 64px;"></div>
                <h2 data-i18n="modalTitle"></h2>
                <p><span data-i18n="modalText"></span> <strong id="room-display"></strong></p>
                <form id="nickname-form" onsubmit="return false;">
                    <input type="text" id="nickname-input" maxlength="15" required autocomplete="off" data-i18n-placeholder="placeholderNickname">
                    <button type="submit" data-i18n="btnConnect"></button>
                    <button type="button" id="random-nickname" data-i18n="btnRandom"></button>
                </form>
            </div>
        </div>

        <!-- Confirm Modal -->
        <div id="confirm-overlay" class="overlay hidden">
            <div class="modal confirm-modal">
                <div class="modal-icon warning"><i class="fas fa-exclamation-triangle"></i></div>
                <h3 id="confirm-title">Confirm</h3>
                <p id="confirm-text">Are you sure you want to do this?</p>
                <div class="modal-actions">
                    <button id="confirm-cancel-btn" class="secondary-btn">Cancel</button>
                    <button id="confirm-yes-btn" class="danger-btn">Yes, Delete</button>
                </div>
            </div>
        </div>

        <!-- Expiry Modal -->
        <div id="expiry-overlay" class="overlay hidden">
            <div class="modal">
                <div class="modal-icon"><i class="fas fa-hourglass-half"></i></div>
                <h3 data-i18n="expiryTitle">Message Expiry</h3>
                <p data-i18n="expiryDesc">Choose how long messages last in this room.</p>
                <div class="expiry-options">
                    <button class="expiry-option" data-value="1">1 Hour</button>
                    <button class="expiry-option" data-value="6">6 Hours</button>
                    <button class="expiry-option" data-value="12">12 Hours</button>
                    <button class="expiry-option active" data-value="24">24 Hours</button>
                    <button class="expiry-option" data-value="168">7 Days</button>
                </div>
                <button id="expiry-close-btn" class="secondary-btn" style="margin-top: 1rem;">Close</button>
            </div>
        </div>


        <!-- Header -->
        <header class="chat-header">
            <a href="/" class="logo-link">
                <div class="logo">
                     <img src="/logo.svg" alt="Talk2" class="brand-logo">
                    <span>Talk2</span>
                </div>
            </a>
            <div class="room-info">
                <span class="room-badge"><i class="fas fa-hashtag"></i><span id="room-name-header"></span></span>
                <span class="user-count-badge"><i class="fas fa-users"></i><span id="user-count">0</span></span>
            </div>
            <div class="header-controls">
                <button id="share-link-btn" class="icon-btn" title="Linki Payla≈ü">
                    <i class="fas fa-share-alt"></i>
                </button>
                <button id="sound-toggle-btn" class="icon-btn" title="Bildirim Sesi">
                    <i class="fas fa-volume-up"></i>
                </button>
                <div class="lang-dropdown" id="lang-dropdown">
                    <button class="lang-dropdown-btn" id="lang-dropdown-btn">
                        <img src="/flags/us.svg" class="lang-flag" id="current-flag" alt="">
                        <span id="current-lang-text">EN</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="lang-dropdown-menu" id="lang-dropdown-menu">
                        <div class="lang-option" data-lang="en"><img src="/flags/us.svg" class="lang-flag" alt=""> English</div>
                        <div class="lang-option" data-lang="tr"><img src="/flags/tr.svg" class="lang-flag" alt=""> T√ºrk√ße</div>
                        <div class="lang-option" data-lang="de"><img src="/flags/de.svg" class="lang-flag" alt=""> Deutsch</div>
                        <div class="lang-option" data-lang="ru"><img src="/flags/ru.svg" class="lang-flag" alt=""> –†—É—Å—Å–∫–∏–π</div>
                        <div class="lang-option" data-lang="ph"><img src="/flags/ph.svg" class="lang-flag" alt=""> Filipino</div>
                        <div class="lang-option" data-lang="es"><img src="/flags/es.svg" class="lang-flag" alt=""> Espa√±ol</div>
                        <div class="lang-option" data-lang="fr"><img src="/flags/fr.svg" class="lang-flag" alt=""> Fran√ßais</div>
                        <div class="lang-option" data-lang="it"><img src="/flags/it.svg" class="lang-flag" alt=""> Italiano</div>
                        <div class="lang-option" data-lang="pt"><img src="/flags/br.svg" class="lang-flag" alt=""> Portugu√™s</div>
                    </div>
                </div>
                <div class="translate-dropdown" id="translate-dropdown">
                    <button class="translate-dropdown-btn" id="translate-dropdown-btn" title="√áeviri Dili">
                        <i class="fas fa-language"></i>
                        <span id="translate-lang-text">--</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="translate-dropdown-menu" id="translate-dropdown-menu">
                        <div class="translate-dropdown-header">Translate to:</div>
                        <div class="translate-dropdown-scroll">
                            <div class="translate-lang-option" data-lang="en"><img src="/flags/us.svg" class="lang-flag" alt="">English</div>
                            <div class="translate-lang-option" data-lang="tr"><img src="/flags/tr.svg" class="lang-flag" alt="">T√ºrk√ße</div>
                            <div class="translate-lang-option" data-lang="de"><img src="/flags/de.svg" class="lang-flag" alt="">Deutsch</div>
                            <div class="translate-lang-option" data-lang="ru"><img src="/flags/ru.svg" class="lang-flag" alt="">–†—É—Å—Å–∫–∏–π</div>
                            <div class="translate-lang-option" data-lang="es"><img src="/flags/es.svg" class="lang-flag" alt="">Espa√±ol</div>
                            <div class="translate-lang-option" data-lang="fr"><img src="/flags/fr.svg" class="lang-flag" alt="">Fran√ßais</div>
                            <div class="translate-lang-option" data-lang="it"><img src="/flags/it.svg" class="lang-flag" alt="">Italiano</div>
                            <div class="translate-lang-option" data-lang="pt"><img src="/flags/br.svg" class="lang-flag" alt="">Portugu√™s</div>
                            <div class="translate-lang-option" data-lang="zh"><img src="/flags/cn.svg" class="lang-flag" alt="">‰∏≠Êñá</div>
                            <div class="translate-lang-option" data-lang="ja"><img src="/flags/jp.svg" class="lang-flag" alt="">Êó•Êú¨Ë™û</div>
                            <div class="translate-lang-option" data-lang="ko"><img src="/flags/kr.svg" class="lang-flag" alt="">ÌïúÍµ≠Ïñ¥</div>
                            <div class="translate-lang-option" data-lang="ar"><img src="/flags/sa.svg" class="lang-flag" alt="">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</div>
                            <div class="translate-lang-option" data-lang="hi"><img src="/flags/in.svg" class="lang-flag" alt="">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</div>
                            <div class="translate-lang-option" data-lang="nl"><img src="/flags/nl.svg" class="lang-flag" alt="">Nederlands</div>
                            <div class="translate-lang-option" data-lang="pl"><img src="/flags/pl.svg" class="lang-flag" alt="">Polski</div>
                            <div class="translate-lang-option" data-lang="sv"><img src="/flags/se.svg" class="lang-flag" alt="">Svenska</div>
                            <div class="translate-lang-option" data-lang="da"><img src="/flags/dk.svg" class="lang-flag" alt="">Dansk</div>
                            <div class="translate-lang-option" data-lang="no"><img src="/flags/no.svg" class="lang-flag" alt="">Norsk</div>
                            <div class="translate-lang-option" data-lang="fi"><img src="/flags/fi.svg" class="lang-flag" alt="">Suomi</div>
                            <div class="translate-lang-option" data-lang="el"><img src="/flags/gr.svg" class="lang-flag" alt="">ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨</div>
                            <div class="translate-lang-option" data-lang="cs"><img src="/flags/cz.svg" class="lang-flag" alt="">ƒåe≈°tina</div>
                            <div class="translate-lang-option" data-lang="ro"><img src="/flags/ro.svg" class="lang-flag" alt="">Rom√¢nƒÉ</div>
                            <div class="translate-lang-option" data-lang="hu"><img src="/flags/hu.svg" class="lang-flag" alt="">Magyar</div>
                            <div class="translate-lang-option" data-lang="uk"><img src="/flags/ua.svg" class="lang-flag" alt="">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</div>
                            <div class="translate-lang-option" data-lang="th"><img src="/flags/th.svg" class="lang-flag" alt="">‡πÑ‡∏ó‡∏¢</div>
                            <div class="translate-lang-option" data-lang="vi"><img src="/flags/vn.svg" class="lang-flag" alt="">Ti·∫øng Vi·ªát</div>
                            <div class="translate-lang-option" data-lang="id"><img src="/flags/id.svg" class="lang-flag" alt="">Indonesia</div>
                            <div class="translate-lang-option" data-lang="ms"><img src="/flags/my.svg" class="lang-flag" alt="">Melayu</div>
                            <div class="translate-lang-option" data-lang="tl"><img src="/flags/ph.svg" class="lang-flag" alt="">Filipino</div>
                            <div class="translate-lang-option" data-lang="he"><img src="/flags/il.svg" class="lang-flag" alt="">◊¢◊ë◊®◊ô◊™</div>
                        </div>
                    </div>
                </div>
                <button id="auto-translate-btn" class="icon-btn" title="Otomatik √áeviri">
                    <i class="fas fa-magic"></i>
                </button>
                <button id="expiry-btn" class="icon-btn" title="Mesaj S√ºresi">
                    <i class="fas fa-history"></i>
                </button>
                <button id="logout-btn" class="icon-btn" title="√áƒ±kƒ±≈ü Yap">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
                <button id="toggle-sidebar" class="toggle-sidebar-btn" title="Kullanƒ±cƒ±larƒ± G√∂ster">
                    <i class="fas fa-users"></i>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="chat-wrapper">
            <!-- Chat Area -->
            <div class="chat-main">
                <!-- System Banner -->
                <div class="system-banner">
                    <i class="fas fa-meteor"></i> <span data-i18n="systemBanner">Bu odadaki veriler her 24 saatte bir silinir.</span>
                </div>

                <!-- Chat Container -->
                <main class="chat-container">
                    <div id="messages" class="messages-list"></div>
                    <div id="typing-indicator" class="typing-indicator hidden"></div>
                    
                    <!-- Scroll to Bottom Button -->
                    <button id="scroll-bottom-btn" class="scroll-bottom-btn hidden" title="Alta git">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </main>

                <!-- Input Area -->
                <footer class="input-area">
                    <!-- Reply Preview -->
                    <div id="reply-preview" class="reply-preview hidden">
                        <div class="reply-info">
                            <i class="fas fa-reply"></i>
                            <span id="reply-to-name"></span>: <span id="reply-to-text"></span>
                        </div>
                        <button type="button" id="cancel-reply" class="cancel-reply-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="chat-form" onsubmit="return false;">
                    <!-- Recording Indicator -->
                    <div id="recording-bar" class="recording-bar hidden">
                        <div class="recording-pulse"></div>
                        <span id="recording-time">0:00</span>
                        <canvas id="recording-waveform" class="recording-waveform" width="200" height="32"></canvas>
                        <button type="button" id="cancel-recording" class="recording-cancel-btn"><i class="fas fa-times"></i></button>
                        <button type="button" id="send-recording" class="recording-send-btn"><i class="fas fa-paper-plane"></i></button>
                    </div>
                    <!-- Spoiler Toggle (shown when image selected) -->
                    <div id="spoiler-toggle-bar" class="spoiler-toggle-bar hidden">
                        <label class="spoiler-label">
                            <input type="checkbox" id="spoiler-checkbox">
                            <i class="fas fa-eye-slash"></i> Spoiler
                        </label>
                        <span id="upload-filename" class="upload-filename"></span>
                    </div>
                    <div class="input-wrapper">
                        <button type="button" id="emoji-btn" class="icon-btn"><i class="far fa-smile"></i></button>
                        <button type="button" id="upload-btn" class="icon-btn"><i class="fas fa-paperclip"></i></button>
                        <input type="file" id="image-input" accept="image/*,video/*" style="display: none;">
                        <input type="text" id="message-input" autocomplete="off" data-i18n-placeholder="placeholderMessage">
                        <button type="button" id="mic-btn" class="icon-btn" title="Ses Kaydet"><i class="fas fa-microphone"></i></button>
                        <button type="submit" id="send-btn"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </form>
                </footer>
            </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden"></div>

            <!-- Users Sidebar -->
            <aside id="users-sidebar" class="users-sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-users"></i> <span data-i18n="sidebarTitle">Online</span></h3>
                    <span id="sidebar-user-count" class="sidebar-count">0</span>
                    <button id="close-sidebar-btn" class="icon-btn close-sidebar" style="display: none;"><i class="fas fa-times"></i></button>
                </div>

                <!-- Mobile-only controls (shown in sidebar on small screens) -->
                <div class="sidebar-mobile-controls">
                    <div class="sidebar-controls-row">
                        <button id="share-btn-mobile" class="icon-btn sidebar-ctrl-btn" title="Payla≈ü"><i class="fas fa-share-alt"></i></button>
                        <button id="sound-toggle-mobile" class="icon-btn sidebar-ctrl-btn" title="Ses"><i class="fas fa-volume-up"></i></button>
                        <button id="expiry-btn-mobile" class="icon-btn sidebar-ctrl-btn" title="Mesaj S√ºresi"><i class="fas fa-history"></i></button>
                        <button id="auto-translate-btn-mobile" class="icon-btn sidebar-ctrl-btn" title="Otomatik √áeviri"><i class="fas fa-magic"></i></button>
                        <button id="logout-btn-mobile" class="icon-btn sidebar-ctrl-btn" title="√áƒ±kƒ±≈ü"><i class="fas fa-sign-out-alt"></i></button>
                    </div>
                </div>
                
                <!-- Clear Button -->
                <div class="sidebar-actions">
                    <button id="clear-msgs-btn" class="danger-btn"><i class="fas fa-trash-alt"></i> <span data-i18n="btnClearMyMsgs">Clear My Messages</span></button>
                </div>

                <ul id="users-list" class="users-list"></ul>
                
                <div class="sidebar-footer">
                     <small>Dev: <a href="https://github.com/zveloxy" target="_blank" style="color:var(--text-secondary)">Veloxy</a></small>
                </div>
            </aside>
        </div>

        <!-- Emoji Picker -->
        <div id="emoji-picker" class="emoji-picker hidden">
            <div class="emoji-grid">
                <span>üòÄ</span><span>üòÇ</span><span>üòç</span><span>ü§î</span><span>üòé</span>
                <span>üëç</span><span>üëé</span><span>‚ù§Ô∏è</span><span>üî•</span><span>üíØ</span>
                <span>üéâ</span><span>üöÄ</span><span>‚ú®</span><span>üíÄ</span><span>üëÄ</span>
                <span>ü§£</span><span>üòè</span><span>ü•≤</span><span>üòà</span><span>ü§Ø</span>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast-notification" class="toast-notification hidden">
        <i class="fas fa-exclamation-circle"></i>
        <span id="toast-message"></span>
    </div>

    <!-- Image Lightbox Modal -->
    <div id="lightbox-modal" class="lightbox-modal hidden">
        <span class="lightbox-close">&times;</span>
        <img id="lightbox-image" src="" alt="Enlarged Image">
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/client.js?v=67"></script>
</body>
</html>
