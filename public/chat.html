<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Talk2 Chat</title>
    <link rel="stylesheet" href="/style.css?v=12">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icons/7.2.3/css/flag-icons.min.css">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <meta name="theme-color" content="#6366f1">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js');
            });
        }
    </script>
</head>
<body>
    <div id="app">
        <!-- Nickname Modal -->
        <div id="nickname-overlay" class="overlay">
            <div class="modal" id="nickname-modal" style="opacity: 0; transition: opacity 0.3s;">
                <div class="modal-icon"><img src="/logo.svg" alt="Logo" style="width: 64px; height: 64px;"></div>
                <h2 data-i18n="modalTitle"></h2>
                <p><span data-i18n="modalText"></span> <strong id="room-display"></strong></p>
                <form id="nickname-form" onsubmit="return false;">
                    <input type="text" id="nickname-input" maxlength="15" required autocomplete="off" data-i18n-placeholder="placeholderNickname">
                    <button type="submit" data-i18n="btnConnect"></button>
                    <button type="button" id="random-nickname" data-i18n="btnRandom"></button>
                </form>
            </div>
        </div>

        <!-- Confirm Modal -->
        <div id="confirm-overlay" class="overlay hidden">
            <div class="modal confirm-modal">
                <div class="modal-icon warning"><i class="fas fa-exclamation-triangle"></i></div>
                <h3 id="confirm-title">Confirm</h3>
                <p id="confirm-text">Are you sure you want to do this?</p>
                <div class="modal-actions">
                    <button id="confirm-cancel-btn" class="secondary-btn">Cancel</button>
                    <button id="confirm-yes-btn" class="danger-btn">Yes, Delete</button>
                </div>
            </div>
        </div>

        <!-- Expiry Modal -->
        <div id="expiry-overlay" class="overlay hidden">
            <div class="modal">
                <div class="modal-icon"><i class="fas fa-hourglass-half"></i></div>
                <h3 data-i18n="expiryTitle">Message Expiry</h3>
                <p data-i18n="expiryDesc">Choose how long messages last in this room.</p>
                <div class="expiry-options">
                    <button class="expiry-option" data-value="1">1 Hour</button>
                    <button class="expiry-option" data-value="6">6 Hours</button>
                    <button class="expiry-option" data-value="12">12 Hours</button>
                    <button class="expiry-option active" data-value="24">24 Hours</button>
                    <button class="expiry-option" data-value="168">7 Days</button>
                </div>
                <button id="expiry-close-btn" class="secondary-btn" style="margin-top: 1rem;">Close</button>
            </div>
        </div>

        <!-- Header -->
        <header class="chat-header">
            <a href="/" class="logo-link">
                <div class="logo">
                     <img src="/logo.svg" alt="Talk2" class="brand-logo">
                    <span>Talk2</span>
                </div>
            </a>
            <div class="room-info">
                <span class="room-badge"><i class="fas fa-hashtag"></i><span id="room-name-header"></span></span>
                <span class="user-count-badge"><i class="fas fa-users"></i><span id="user-count">0</span></span>
            </div>
            <div class="header-controls">
                <button id="share-link-btn" class="icon-btn" title="Linki PaylaÅŸ">
                    <i class="fas fa-share-alt"></i>
                </button>
                <button id="sound-toggle-btn" class="icon-btn" title="Bildirim Sesi">
                    <i class="fas fa-volume-up"></i>
                </button>
                <div class="lang-dropdown" id="lang-dropdown">
                    <button class="lang-dropdown-btn" id="lang-dropdown-btn">
                        <img src="/flags/us.svg" class="lang-flag" id="current-flag" alt="">
                        <span id="current-lang-text">EN</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="lang-dropdown-menu" id="lang-dropdown-menu">
                        <div class="lang-option" data-lang="en"><img src="/flags/us.svg" class="lang-flag" alt=""> English</div>
                        <div class="lang-option" data-lang="tr"><img src="/flags/tr.svg" class="lang-flag" alt=""> TÃ¼rkÃ§e</div>
                        <div class="lang-option" data-lang="de"><img src="/flags/de.svg" class="lang-flag" alt=""> Deutsch</div>
                        <div class="lang-option" data-lang="ru"><img src="/flags/ru.svg" class="lang-flag" alt=""> Ğ ÑƒÑÑĞºĞ¸Ğ¹</div>
                        <div class="lang-option" data-lang="ph"><img src="/flags/ph.svg" class="lang-flag" alt=""> Filipino</div>
                        <div class="lang-option" data-lang="es"><img src="/flags/es.svg" class="lang-flag" alt=""> EspaÃ±ol</div>
                        <div class="lang-option" data-lang="fr"><img src="/flags/fr.svg" class="lang-flag" alt=""> FranÃ§ais</div>
                        <div class="lang-option" data-lang="it"><img src="/flags/it.svg" class="lang-flag" alt=""> Italiano</div>
                        <div class="lang-option" data-lang="pt"><img src="/flags/br.svg" class="lang-flag" alt=""> PortuguÃªs</div>
                    </div>
                </div>
                <button id="expiry-btn" class="icon-btn" title="Mesaj SÃ¼resi">
                    <i class="fas fa-history"></i>
                </button>
                <button id="logout-btn" class="icon-btn" title="Ã‡Ä±kÄ±ÅŸ Yap">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
                <button id="toggle-sidebar" class="toggle-sidebar-btn" title="KullanÄ±cÄ±larÄ± GÃ¶ster">
                    <i class="fas fa-users"></i>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="chat-wrapper">
            <!-- Chat Area -->
            <div class="chat-main">
                <!-- System Banner -->
                <div class="system-banner">
                    <i class="fas fa-meteor"></i> <span data-i18n="systemBanner">Bu odadaki veriler her 24 saatte bir silinir.</span>
                </div>

                <!-- Chat Container -->
                <main class="chat-container">
                    <div id="messages" class="messages-list"></div>
                    <div id="typing-indicator" class="typing-indicator hidden"></div>
                </main>

                <!-- Input Area -->
                <footer class="input-area">
                    <!-- Reply Preview -->
                    <div id="reply-preview" class="reply-preview hidden">
                        <div class="reply-info">
                            <i class="fas fa-reply"></i>
                            <span id="reply-to-name"></span>: <span id="reply-to-text"></span>
                        </div>
                        <button type="button" id="cancel-reply" class="cancel-reply-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="chat-form" onsubmit="return false;">
                    <div class="input-wrapper">
                        <button type="button" id="emoji-btn" class="icon-btn"><i class="far fa-smile"></i></button>
                        <button type="button" id="upload-btn" class="icon-btn"><i class="fas fa-paperclip"></i></button>
                        <input type="file" id="image-input" accept="image/*,video/*" style="display: none;">
                        <input type="text" id="message-input" autocomplete="off" data-i18n-placeholder="placeholderMessage">

                        <button type="submit" id="send-btn"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </form>
                </footer>
            </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden"></div>

            <!-- Users Sidebar -->
            <aside id="users-sidebar" class="users-sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-users"></i> <span data-i18n="sidebarTitle">Online</span></h3>
                    <span id="sidebar-user-count" class="sidebar-count">0</span>
                    <button id="close-sidebar-btn" class="icon-btn close-sidebar" style="display: none;"><i class="fas fa-times"></i></button>
                </div>
                
                <!-- Clear Button -->
                <div class="sidebar-actions">
                    <button id="clear-msgs-btn" class="danger-btn"><i class="fas fa-trash-alt"></i> <span data-i18n="btnClearMyMsgs">Clear My Messages</span></button>
                </div>

                <ul id="users-list" class="users-list"></ul>
                
                <div class="sidebar-footer">
                     <small>Dev: <a href="https://github.com/zveloxy" target="_blank" style="color:var(--text-secondary)">Veloxy</a></small>
                </div>
            </aside>
        </div>

        <!-- Emoji Picker -->
        <div id="emoji-picker" class="emoji-picker hidden">
            <div class="emoji-grid">
                <span>ğŸ˜€</span><span>ğŸ˜‚</span><span>ğŸ˜</span><span>ğŸ¤”</span><span>ğŸ˜</span>
                <span>ğŸ‘</span><span>ğŸ‘</span><span>â¤ï¸</span><span>ğŸ”¥</span><span>ğŸ’¯</span>
                <span>ğŸ‰</span><span>ğŸš€</span><span>âœ¨</span><span>ğŸ’€</span><span>ğŸ‘€</span>
                <span>ğŸ¤£</span><span>ğŸ˜</span><span>ğŸ¥²</span><span>ğŸ˜ˆ</span><span>ğŸ¤¯</span>
            </div>
        </div>
    </div>

    <!-- Image Lightbox Modal -->
    <div id="lightbox-modal" class="lightbox-modal hidden">
        <span class="lightbox-close">&times;</span>
        <img id="lightbox-image" src="" alt="Enlarged Image">
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/client.js?v=28"></script>
</body>
</html>
